# 8ì›” 31ì¼ (ìˆ˜)

### Docker Hostì˜ ëª¨ë“  ì»¨í…Œì´ë„ˆ(ì‹¤í–‰ì¤‘/ì¢…ë£Œëœ ì»¨í…Œì´ë„ˆ) ì •ë¦¬

`docker container rm -f $(docker container ls -a -q)`

> -fë¥¼ ë¹¼ë©´ ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆëŠ” ì œì™¸
> 

### ì»¨í…Œì´ë„ˆ IDë¥¼ ë°˜í™˜

`docker container ls -a -q`

### Foreground/Background ì‹¤í–‰

ì»¨í…Œì´ë„ˆë¥¼ Foregroundë¡œ ì‹¤í–‰í•˜ê±°ë‚˜ attachë¡œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì§„ì…ì‹œ ì»¨í…Œì´ë„ˆë¥¼ ì¢…ë£Œí•˜ì§€ ì•Šê³  ë¹ ì ¸ë‚˜ì˜¤ëŠ” ë°©ë²• ì‹¤ìŠµ

===

```bash
`docker container run -i -t --name centos7_4 centos:7`

( ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì§„ì… ìƒíƒœì—ì„œ [Ctrl]+[P] [Ctrl]+[Q] )

`docker container ls`

CONTAINER ID Â  IMAGEÂ  Â  Â  Â  Â  COMMANDÂ  Â  Â  Â  Â  Â  Â  CREATEDÂ  Â  Â  Â  Â  STATUSÂ  Â  Â  Â  Â  PORTS Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  NAMES

cdc2a5072c36 Â  centos:7 Â  Â  Â  "/bin/bash"Â  Â  Â  Â  Â  27 seconds ago Â  Up 26 seconds Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  centos7_4

```

## ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì§„ì… ë°©ë²•

### ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— ì—°ê²°

`docker container attach CONTAINER`

### ì»¨í…Œì´ë„ˆì— ìƒˆë¡œìš´ ì‰˜ ì‹¤í–‰

`docker container exec -i -t CONAINER /bin/bash`

### ì»¨í…Œì´ë„ˆì— ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰

`docker container exec [OPTION] CONAINER COMMAND [ARG]...`

### ì»¨í…Œì´ë„ˆ ë‚´ì˜ ì‹¤í–‰ í”„ë¡œì„¸ìŠ¤ ëª©ë¡ í™•ì¸

`docker container top CONTAINER`

`( docker container exec CONTAINER ps -ef )`

### ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸

`docker container logs [OPTION] CONTAINER`

===

### ì‹¤í–‰ì¤‘ ì»¨í…Œì´ë„ˆ ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸ ì‹¤ìŠµ

`docker container run -d -p 80:80 --name web5 httpd:2.4.54`

`docker container logs -f web5`

(ë‹¤ë¥¸ íƒ­ì—ì„œ)

`curl http://localhost/`

(ì´ì „ íƒ­ì—ì„œ ìƒˆë¡œ ì¶”ê°€ëœ ë¡œê·¸ í™•ì¸)

172.17.0.1 - - [31/Aug/2022:03:04:30 +0000] "GET / HTTP/1.1" 200 45

172.17.0.1 - - [31/Aug/2022:03:04:31 +0000] "GET / HTTP/1.1" 200 45

===

### Docker Hostì—ì„œ ì»¨í…Œì´ë„ˆë¡œ íŒŒì¼/ë””ë ‰í„°ë¦¬ ë³µì‚¬

`docker container cp DOCKER_HOST_PATHÂ  CONTAINER:CONTAINER_PATH`

`docker container cp /home/user/host_file1 centos7_3:/tmp/`

`docker container cp host_file2 centos7_3:/tmp/`

### ì»¨í…Œì´ë„ˆì—ì„œ Docker Hostë¡œ íŒŒì¼/ë””ë ‰í„°ë¦¬ ë³µì‚¬

`docker container cp CONTAINER:CONTAINER_PATHÂ  DOCKER_HOST_PATH`

### ì»¨í…Œì´ë„ˆ ë‚´ì˜ íŒŒì¼ ë³€ê²½ì‚¬í•­ í™•ì¸

`docker container diff CONTAINER`

- A : ì¶”ê°€ëœ í•­ëª©
- C : ë³€ê²½ëœ í•­ëª©
- D:  ì œê±°ëœ í•­ëª©

<aside>
ğŸ’¡ Union mount File System
dockerëŠ” í•˜ë‚˜ì˜ íŒŒì¼ì‹œìŠ¤í…œìœ¼ë¡œ ìˆëŠ”ê²ƒì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œì˜ íŒŒì¼ì‹œìŠ¤í…œ ë ˆì´ì–´ë“¤ì´ í•©ì³ì ¸ì„œ íŒŒì¼ì„ ê´€ë¦¬
íŒŒì¼ì˜ ë³€í™”ë“¤ì´ í™•ì¸ ê°€ëŠ¥í•œ ì´ìœ ëŠ” ë„ì»¤ê°€ UFSë¡œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ë•Œë¬¸

</aside>

### ì¢…ë£Œëœ ì»¨í…Œì´ë„ˆ ëª¨ë‘ ì‚­ì œ

`docker container prune`

## ì»¨í…Œì´ë„ˆ í™œìš©

### ì»¨í…Œì´ë„ˆì— í™˜ê²½ ë³€ìˆ˜ë¥¼ ì§€ì •í•˜ì—¬ ì‹¤í–‰

`docker container run -i -t --name CONTAINER -e "VARIABLE=VALUE" IMAGE_REPO:TAG`

===

### ì»¨í…Œì´ë„ˆ í™˜ê²½ë³€ìˆ˜ ì‹¤ìŠµ

```bash
$ docker container run -i -t --name centos7_5 -e "VAR1=goorm" centos:7

[root@3326286966d7 /]#

[root@3326286966d7 /]# env | grep -i VAR1

VAR1=goorm

[root@3326286966d7 /]# echo $VAR1

goorm

```

### CPUÂ  ì œí•œí•˜ì—¬ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

`docker container run -i -t --name CONTAINER --cpus CPUS IMAGE_REPO:TAG`

```bash
docker container stats
(ë‹¤ë¥¸ íƒ­ì—ì„œ)
docker container run -it --name c1 --cpus 0.3 centos:7

```

### RAM ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•˜ì—¬ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

`docker container run -i -t --name CONTAINER --memory MEMORY IMAGE_REPO:TAG`

```bash
ì»¨í…Œì´ë„ˆì˜ RAM ë¦¬ì†ŒìŠ¤ ì œí•œ ì‹¤ìŠµ
docker container stats 

(ë‹¤ë¥¸ íƒ­ì—ì„œ)
docker container run -i -t --name c2 --memory 512m centos:7

(ì´ì „ íƒ­ì—ì„œ)
# í•´ë‹¹ ì»¨í…Œì´ë„ˆì˜ ë©”ëª¨ë¦¬ ì œí•œì„ í™•ì¸í•˜ë©´ ì§€ì •í•œ ì œí•œê°’ì´ ì ìš©ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ.
CONTAINER ID   NAME        CPU %     MEM USAGE / LIMIT     MEM %     NET I/O           BLOCK I/O        PIDS
fa719697865a   c2          0%        19.17MiB / 512MiB     3.74%     656B / 0B         43.8MB / 0B   
cdc2a5072c36   centos7_4   0.00%     700KiB / 1.795GiB     0.04%     814B / 0B         0B / 0B
```

## Docker Volume

### Dockerì—ì„œì˜ ë°ì´í„° ê´€ë¦¬

ì»¨í…Œì´ë„ˆì—ì„œ ìƒì„±ë˜ëŠ” ëª¨ë“  íŒŒì¼ì€ R/W Layerì— ì €ì¥ë¨.

ì»¨í…Œì´ë„ˆì˜ R/W Layerì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  íŒŒì¼ì€ ì»¨í…Œì´ë„ˆ ì‚­ì œì‹œ ê°™ì´ ì‚­ì œë¨.

Dockerì—ì„œ ì €ì¥ê³µê°„ì„ ì œê³µí•˜ëŠ” ë°©ë²•

- Bind Mount : Docker Host Filesystemì˜ ë””ë ‰í„°ë¦¬ì˜ ì €ì¥ê³µê°„ì„ ì»¨í…Œì´ë„ˆì— ì œê³µí•˜ëŠ” ë°©ì‹ (ì»¨í…Œì´ë„ˆì—ì„œ Docker Hostì˜ ë””ë ‰í„°ë¦¬ì— ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì—°ê²°)

- Docker Volume : Dockerì˜ Volume Objectë¥¼ ìƒì„±í•˜ì—¬ ì»¨í…Œì´ë„ˆì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì €ì¥ê³µê°„ì„ ì œê³µí•˜ëŠ” ë°©ì‹

ì°¸ê³  : https://docs.docker.com/storage/volumes/

[https://lh4.googleusercontent.com/7PfuSb0OYs3CZALXmHdse36XKUiDwBnFkNrIgFJ17CwRa4p0_K_KwAtRI4e4EjW_RdJuOzfud29CBfXNgmsKchCto3kIk-mD0x9MqVtPZlEsyTplWnYiSbdaCsFhJy5Vi9Ie8PkLykEnlRtOGchZNlk](https://lh4.googleusercontent.com/7PfuSb0OYs3CZALXmHdse36XKUiDwBnFkNrIgFJ17CwRa4p0_K_KwAtRI4e4EjW_RdJuOzfud29CBfXNgmsKchCto3kIk-mD0x9MqVtPZlEsyTplWnYiSbdaCsFhJy5Vi9Ie8PkLykEnlRtOGchZNlk)

### ì»¨í…Œì´ë„ˆì— Bind Mount ì—°ê²°

`docker container run -d -t **-v DOCKER_HOST_PATH:CONTAINER_PATH** --name CONTAINER IMAGE_REPO:TAG`

### Bind Mount ë¹„êµ ì‹¤ìŠµ

```bash
ì¼ë°˜ ì›¹ ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

docker container run -d -p 8081:80 --name web1 httpd:2.4.54

echo "web1 web content" > index.html

docker container cp index.html web1:/usr/local/apache2/htdocs/

curl http://localhost:8081

web1 web content

(Docker Hostì—ì„œ) Bind Mountë¡œ ì»¨í…Œì´ë„ˆì— ì œê³µí•  ë””ë ‰í„°ë¦¬ ìƒì„±

mkdir web_dir

Bind Mount ì ìš©í•œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

docker container run -d -p 8082:80 -v /home/user/web_dir/:/usr/local/apache2/htdocs/ --name web2 httpd:2.4.54

ì»¨í…Œì´ë„ˆ ì§„ì… í›„ íŒŒì¼ ìƒì„±

docker container exec -i -t web2 /bin/bash

root@87637b967390:/usr/local/apache2# cd htdocs

root@87637b967390:/usr/local/apache2/htdocs# echo "web2 bind mount web content" > index.html

íŒŒì¼ ë³µì‚¬ (Docker Host -> Container)

echo "bind mount(docker container cp)" > test1.html

docker container cp test1.html web2:/usr/local/apache2/htdocs/

Docker Hostì—ì„œ Bind Mount ë””ë ‰í„°ë¦¬ ì§ì ‘ ì ‘ê·¼

cd ~

cd web_dir/

tocuh test2.html

echo "bind mount (Direct access)" > test2.html

ls

íŒŒì¼ ëª©ë¡ í™•ì¸ì„ í†µí•´ ê°ê¸° ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ìƒì„±í•œ íŒŒì¼ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ í™•ì¸

ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì˜ ì €ì¥ê³µê°„ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì¼ë°˜ ì»¨í…Œì´ë„ˆì—ì„œ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œ ì»¨í…Œì´ë„ˆë¡œ íŒŒì¼ì„ ë³µì‚¬í•˜ê±°ë‚˜ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•¨.

touch testa.html

echo "docker container cp" > testa.html

docker container cp testa.html web1:/usr/local/apache2/htdocs/

docker container exec -i -t web1 /bin/bash

root@c1b19f38807b:/usr/local/apache2# cd htdocs/

root@c1b19f38807b:/usr/local/apache2/htdocs# touch testb.html

root@c1b19f38807b:/usr/local/apache2/htdocs# echo "container work" > testb.html

root@c1b19f38807b:/usr/local/apache2/htdocs# cat index.html

web1 web content

root@c1b19f38807b:/usr/local/apache2/htdocs# cat testa.html

docker container cp

root@c1b19f38807b:/usr/local/apache2/htdocs# cat testb.html

container work
```